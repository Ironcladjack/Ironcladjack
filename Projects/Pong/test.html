<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Gamedev Canvas Workshop</title>
    <style>
    	* { padding: 0; margin: 50px; }
    	canvas { background: #eeb; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<canvas id="myCanvas" width="480" height="480"></canvas>

<script>
let canvas = document.getElementById("myCanvas");
let ctx = canvas.getContext("2d");

let playerWidth = 50;
let playerHeight = 50;
let playerX = (canvas.width - playerWidth)/2;
let playerY = (canvas.height - playerHeight)/2;

let foodX = Math.random()*canvas.width;
let foodY = Math.random()*canvas.height;
let foodDiameter = 20;

let badX = Math.random()*canvas.width;
let badY = Math.random()*canvas.height;
let badDiameter = 30;

let speed = 2;

let dx = speed;
let dy = speed;

let leftPressed = false;
let rightPressed = false;
let upPressed = false;
let downPressed = false;

let score = 0;
let gainTimer = 1;
let timer = 0;
let lives = 3;

document.addEventListener("keydown", keyDownHandler, false);
document.addEventListener("keyup", keyUpHandler, false);

function keyDownHandler(e) {
    if(e.keyCode == 39) {
        rightPressed = true;
    }
    else if(e.keyCode == 37) {
        leftPressed = true;
    }
    else if(e.keyCode == 38) {
        upPressed = true;
    }
    else if(e.keyCode == 40) {
        downPressed = true;
    }


}
function keyUpHandler(e) {
    if(e.keyCode == 39) {
        rightPressed = false;
    }
    else if(e.keyCode == 37) {
        leftPressed = false;
    }
    else if(e.keyCode == 38) {
        upPressed = false;
    }
    else if(e.keyCode == 40) {
        downPressed = false;
    }
}

function drawPlayer() {
  ctx.beginPath();
  ctx.rect(playerX, playerY, playerWidth, playerHeight);
  //	(x, y, width, height);
  ctx.fillStyle = "#0000FF";
  ctx.fill();
  ctx.closePath();
};

function isPressed() {
  if (leftPressed == true && playerX > 0) {
    playerX -= dx;
  }
  if (rightPressed == true && playerX < canvas.width-playerWidth) {
    playerX += dx;
  }
  if (upPressed == true && playerY > 0) {
    playerY -= dy;
  }
  if (downPressed == true && playerY < canvas.height-playerHeight) {
    playerY += dy;
  }
};

function drawFood() {
  ctx.beginPath();
  ctx.arc(foodX,foodY, foodDiameter, 0 , Math.PI*2, false);
  //	(x, y, radius, start angle, end angle, direction);
  ctx.fillStyle = "#00FF00";
  ctx.fill();
  ctx.closePath();
};

function drawBad() {
    ctx.beginPath();
  ctx.arc(badX,badY, badDiameter, 0 , Math.PI*2, false);
  //	(x, y, radius, start angle, end angle, direction);
  ctx.fillStyle = "#FF0000";
  ctx.fill();
  ctx.closePath();
}

function drawScore() {
    ctx.font = "16px Arial";
    ctx.fillStyle = "#0095DD";
    ctx.fillText("Score: "+score, 8, 20);
}

function drawTime() {
    timer+= 0.01;
    let time = timer.toFixed(0);
    ctx.font = "16px Arial";
    ctx.fillStyle = "#0095DD";
    ctx.fillText("Time: "+time, 8, 40);
}

var lives = [];
for (let i = 0; i < lives; i++) {
  lives[i].status = 1
}

function drawLives() {
  for (let i = 0; i < lives; i++) {
    let lifeX = canvas.width - (i * 35 + 15);
    let lifeY = 20;
    ctx.beginPath();
    ctx.arc(lifeX,lifeY, 15, 0 , Math.PI*2, false);
    //	(x, y, radius, start angle, end angle, direction);
    ctx.fillStyle = "#FFFF00";
    ctx.fill();
    ctx.closePath();
  }
}

function drawGain(gain) {
  let gainX = playerX;
  let gainY = playerY;
  ctx.font = "16px Arial";
  ctx.fillStyle = "#0095DD";
  ctx.fillText("+"+gain, gainX, gainY);
}

function drawLoss(loss) {
  let gainX = playerX;
  let gainY = playerY;
  ctx.font = "16px Arial";
  ctx.fillStyle = "#0095DD";
  ctx.fillText("-"+loss, gainX, gainY);
}

function foodCollision() {
  if (playerX - foodX < foodDiameter && playerX - foodX > -foodDiameter-playerWidth && playerY - foodY < foodDiameter && playerY - foodY > -foodDiameter-playerHeight) {
    ++score;
    foodX = Math.random()*canvas.width;
    foodY = Math.random()*canvas.height;
    gainTimer = 0;
    dx += 0.1;
    dy += 0.1;
  }
  if (gainTimer < 1) {
    gainTimer += 0.01;
    drawGain(1);
  }
}

function badCollision() {
  if (playerX - badX < badDiameter && playerX - badX > -badDiameter-playerWidth && playerY - badY < badDiameter && playerY - badY > -badDiameter-playerHeight) {
    score -= 5;
    if (score < 0) {
      score = 0;
    }
    badX = Math.random()*canvas.width;
    badY = Math.random()*canvas.height;
    gainTimer = 0;
  }
  if (gainTimer < 1) {
    gainTimer += 0.01;
    drawLoss(5);
  }
}


function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawPlayer();
  drawFood();
  isPressed();
  drawScore();
  drawTime();
  drawLives();
  foodCollision();
  if (score >= 3) {
    drawBad();
    badCollision();
    let badTimer = 0;
    badTimer++;
    if (badTimer > 1000) {
      badX = Math.random()*canvas.width;
      badY = Math.random()*canvas.height;
      badTimer = 0;
    }
  }

}

setInterval(draw, 10);





</script>

</body>
</html>
